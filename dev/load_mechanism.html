<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Loading Mechanism via URDF · Dojo</title><script data-outdated-warner src="assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.044/juliamono.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.13.11/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="assets/documenter.js"></script><script src="siteinfo.js"></script><script src="../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="index.html"><img src="assets/logo.png" alt="Dojo logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href="index.html">Dojo</a></span></div><form class="docs-search" action="search.html"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><a class="tocitem" href="index.html">Get Started</a></li><li><span class="tocitem">Creating a Mechanism</span><ul><li><a class="tocitem" href="define_mechanism.html">Defining a Mechanism</a></li><li class="is-active"><a class="tocitem" href="load_mechanism.html">Loading Mechanism via URDF</a></li></ul></li><li><span class="tocitem">Creating a Simulation</span><ul><li><a class="tocitem" href="define_simulation.html">Defining a Simulation</a></li><li><a class="tocitem" href="define_controller.html">Defining a Controller</a></li><li><a class="tocitem" href="simulation_with_gradients.html">Gradients</a></li></ul></li><li><span class="tocitem">Environments</span><ul><li><a class="tocitem" href="load_environment.html">Load Existing Environment</a></li><li><a class="tocitem" href="define_environment.html">Defining an Environment</a></li><li><a class="tocitem" href="environment_simulation_gradients.html">Gradients</a></li></ul></li><li><span class="tocitem">Gradients from Simulator</span><ul><li><a class="tocitem" href="simulation_with_gradients.html">Gradients</a></li><li><a class="tocitem" href="gradients.html">Background</a></li></ul></li><li><span class="tocitem">Examples</span><ul><li><a class="tocitem" href="simulation.html">Simulation</a></li><li><a class="tocitem" href="trajectory_optimization.html">Trajectory Optimization</a></li><li><a class="tocitem" href="reinforcement_learning.html">Reinforcement Learning</a></li><li><a class="tocitem" href="system_identification.html">System Identification</a></li></ul></li><li><span class="tocitem">State Representations</span><ul><li><a class="tocitem" href="maximal_representation.html">Maximal Coordinates</a></li><li><a class="tocitem" href="minimal_representation.html">Minimal Coordinates</a></li></ul></li><li><span class="tocitem">Contact Models</span><ul><li><a class="tocitem" href="contact_models.html">Overview</a></li><li><a class="tocitem" href="impact.html">Impact</a></li><li><a class="tocitem" href="nonlinear_friction.html">Nonlinear friction</a></li><li><a class="tocitem" href="linearized_friction.html">Linearized Friction</a></li></ul></li><li><span class="tocitem">Interior-Point Solver</span><ul><li><a class="tocitem" href="interior_point.html">Algorithm</a></li><li><a class="tocitem" href="solver_options.html">Solver Options</a></li></ul></li><li><a class="tocitem" href="faq.html">Frequently Asked Questions</a></li><li><a class="tocitem" href="api.html">API Documentation</a></li><li><a class="tocitem" href="contributing.html">Contributing</a></li><li><a class="tocitem" href="citing.html">Citing</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Creating a Mechanism</a></li><li class="is-active"><a href="load_mechanism.html">Loading Mechanism via URDF</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href="load_mechanism.html">Loading Mechanism via URDF</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/dojo-sim/Dojo.jl/blob/master/docs/src/load_mechanism.md" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><h1 id="Loading-Mechanism-via-URDF"><a class="docs-heading-anchor" href="#Loading-Mechanism-via-URDF">Loading Mechanism via URDF</a><a id="Loading-Mechanism-via-URDF-1"></a><a class="docs-heading-anchor-permalink" href="#Loading-Mechanism-via-URDF" title="Permalink"></a></h1><p>Another way to build a mechanism is to directly load it from a URDF file. We illustrate this with the RExLab hopper.</p><pre><code class="language-julia hljs">function get_rexhopper(;
    timestep=0.01,
    gravity=[0.0; 0.0; -9.81],
    friction_coefficient=1.0,
    contact_body=true,
    limits=true,
    model=:rexhopper,
    floating=true,
    contact_type=:nonlinear,
    spring=0.0,
    damper=1.0,
    T=Float64)

    # we define the path of the URDF file
    path = joinpath(@__DIR__, &quot;../deps/$(String(model)).urdf&quot;)
    # we load the URDF file into a Mechanism object
    mech = Mechanism(path, floating, T,
        gravity=gravity,
        timestep=timestep,
        spring=spring,
        damper=damper)
    return mech
end</code></pre><p>Here, we have created a mechanism, that contains all the bodies and the joint and also the meshes loaded from the path contained in the URDF file. This is the resulting robot; <img src="assets/rexhopper.png" alt="rexhopper"/></p><p>However, we are still missing the joint limits and the contact spheres. The following methods provides an example for adding joint limits and contact spheres. Our goal here was to best approximate the mesh shapes using as few spheres as possible. Parsing joint limits from the URDF to add them automatically to the mechanism should be easily feasible. That could be a great way to contribute and familiarize yourself with the code!</p><pre><code class="language-julia hljs">function get_rexhopper(;
    timestep=0.01,
    gravity=[0.0; 0.0; -9.81],
    friction_coefficient=1.0,
    contact_body=true,
    limits=true,
    model=:rexhopper,
    floating=true,
    contact_type=:nonlinear,
    spring=0.0,
    damper=1.0,
    T=Float64)

    # we define the path of the URDF file
    path = joinpath(@__DIR__, &quot;../deps/$(String(model)).urdf&quot;)
    # we load the URDF file into a Mechanism object
    mech = Mechanism(path, floating, T,
        gravity=gravity,
        timestep=timestep,
        spring=spring,
        damper=damper)

    # we add joint limits to the mechanism
    joints = deepcopy(mech.joints)
    if limits
        joint1 = get_joint(mech, :joint1)
        joint3 = get_joint(mech, :joint3)
        joints[joint1.id] = add_limits(mech, joint1,
            rot_limits=[SVector{1}(-0.7597), SVector{1}(1.8295)])
        joints[joint3.id] = add_limits(mech, joint3,
            rot_limits=[SVector{1}(-1.8295), SVector{1}(0.7597)])
        mech = Mechanism(Origin{T}(), [mech.bodies...], [joints...],
            gravity=gravity,
            timestep=timestep,
            spring=spring,
            damper=damper)
    end

    # we attach spherical collisions zones to certain bodies
    if contact_body
        origin = Origin{T}()
        bodies = mech.bodies
        joints = mech.joints

        normal = [0.0; 0.0; 1.0]
        contacts = []

        link3 = get_body(mech, :link3)
        link2 = get_body(mech, :link2)
        foot_radius = 0.0203
        ankle_radius = 0.025
        base_radius = 0.125
        p = [0.1685; 0.0025; -0.0055]
        o = [0;0; foot_radius]
        push!(contacts, contact_constraint(link3, normal,
            friction_coefficient=friction_coefficient,
            contact_point=p,
            offset=o,
            contact_type=contact_type,
            name=:foot))
        p = [-0.10; -0.002; 0.01]
        o = [0;0; ankle_radius]
        push!(contacts, contact_constraint(link3, normal,
            friction_coefficient=friction_coefficient,
            contact_point=p,
            offset=o,
            contact_type=contact_type,
            name=:ankle3))
        p = [0.24; 0.007; 0.005]
        push!(contacts, contact_constraint(link2, normal,
            friction_coefficient=friction_coefficient,
            contact_point=p,
            offset=o,
            contact_type=contact_type,
            name=:ankle2))
        base_link = get_body(mech, :base_link)
        p = [0.0; 0.0; 0.0]
        o = [0;0; base_radius]
        push!(contacts, contact_constraint(base_link, normal,
            friction_coefficient=friction_coefficient,
            contact_point=p,
            offset=o,
            contact_type=contact_type,
            name=:torso))

        set_minimal_coordinates!(mech, get_joint(mech, :floating_base), [0,0,1.0, 0,0,0])
        mech = Mechanism(origin, bodies, joints, [contacts...],
            gravity=gravity,
            timestep=timestep,
            spring=spring,
            damper=damper)
    end
    return mech
end</code></pre><p>This is the result, we added three spherical contacts to the robot. There is one coverinn the torso one covering the knee and one covering the foot, they are shown in red; <img src="assets/rexhopper_contact.png" alt="rexhopper_contact"/></p></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="define_mechanism.html">« Defining a Mechanism</a><a class="docs-footer-nextpage" href="define_simulation.html">Defining a Simulation »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 0.27.17 on <span class="colophon-date" title="Friday 20 May 2022 21:55">Friday 20 May 2022</span>. Using Julia version 1.7.2.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
